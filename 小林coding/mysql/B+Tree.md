数据页有七个部分（默认是16KB）：

文件头（38字节），页头（56），最大、最小记录（26），用户记录，空闲空间，页目录，文件尾（8）

行记录：最大、最小记录 + 用户记录




| 文件头         | 表示页的信息                             |
| -------------- | ---------------------------------------- |
| 页头           | 表示页的状态信息                         |
| 最大、最小记录 | 这是两个虚拟的伪记录                     |
|                | 分别表示页中的最小记录 和 最大记录       |
| 用户记录       | 存储行记录内容                           |
| 空闲空间       | 页中还没有使用的空间                     |
| 页目录         | 存储用户记录的相对位置，对记录有索引nmlv |
| 文件尾         | 校验页是否完整                           |

|File Header|
|----|
|Page Header|
|Infilmun + Supermum|
|User Records|
|Free Space|
|Page Directory|
|File Trailer|



File Header(文件头) 中有两个指针，分别指向上一个数据页和下一个数据页 ===== 双向链表

使得数据页之间不需要物理上是连续的，只需要在逻辑上是连续的



数据页的主要作用是存储记录（用户记录） ---  存储数据库的数据

数据页中的记录按照“主键”　的顺序连单向链表　

​								----- 插入删除方便，但检索效率低

为了提高检索效率，数据页中有一个页目录



页目录创建过程

将所有的记录划分成几个组，这些记录包括最小记录和最大记录，但不包括标记为　“已删除”的记录

**每个记录组的最后一条记录是组内最大的那条记录**，并且**最后一条记录的头信息中会存储该组的记录总数**

页目录用来存储**每组最后一条记录的地址偏移量**，这些地址偏移量会按照先后顺序存储起来，每组的地址偏移量也就是　槽(slot)，每个槽相当于**指向了不同组的最后一个记录**



由于记录是按照主键从小到大排序的，因此，可以通过定位槽来确定所在的分组，再到组内进行查找



槽内记录数规定：

第一个分组中的记录只能有１条记录

最后一个分组中的记录条数１～８

剩下分组中的记录条数４～８





B+树是如何查询的

有大量记录进行存储时，就会创建多个数据页 --- B+ 树能够快速定位记录所在的页



B+ 树中每个节点是一个数据页

只有在叶子节点才存放数据，在非叶子节点上仅用来存放目录项作为索引

非叶子节点分为不同层次，通过分层来降低每一层的搜索量

所有节点按照索引键大小排序，构成一个双向链表，便于范围查询



InnoDB引擎一定会为表创建一个聚簇索引，且只会有一个

索引的选择：

主键 > 非NULL 唯一列 > 自动生成一个隐式自增的id 列



回表：某个查询语句使用了二级索引，但查询的数据不是主键值，这时在二级索引找到主键值后，需要去聚簇索引中获取数据行（查两个B+ 树）

覆盖索引：当查询的数据是主键值时，只用在二级索引就能查询到，不用再去聚簇索引查询（查一个B+树）







InnoDB引擎 和 MyISAM 引擎都支持B+ 树索引，但是：

InnoDB 引擎的叶子节点保存数据本身，而MyISAM 引擎的叶子节点保存的是数据的物理地址

























